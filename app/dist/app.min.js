/*! qwant-mobile - v - 2013-11-12 */"use strict";var app=angular.module("qwant",["ngRoute","qwant.filters","qwant.services","qwant.directives","qwant.controllers","ngSanitize","infinite-scroll","snap","underscore"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"partials/home.html",controller:"HomeController"}),a.when("/search",{templateUrl:"partials/searchResult.html",controller:"SearchController"}),a.otherwise({redirectTo:"/"})}]);app.services=angular.module("qwant.services",[]),app.controllers=angular.module("qwant.controllers",[]),app.directives=angular.module("qwant.directives",[]),app.filters=angular.module("qwant.filters",[]),app.controllers.controller("HomeController",["$scope","$rootScope","snapRemote",function(a,b,c){b.isHomePage=!0,c.getSnapper().then(function(a){a.settings({minPosition:-290})})}]),app.controllers.controller("SearchController",["$scope","SearchManager","$location","snapRemote","$route","$rootScope",function(a,b,c,d,e,f){a.term=c.search().q,a.search=b,a.$on("$locationChangeSuccess",function(){b.currentPage=1,b.items=[]}),b.source=c.$$search.source,b.nextPage(a.term),f.isHomePage=!1,d.close(),d.getSnapper().then(function(a){a.settings({minPosition:-290})});var g;d.getSnapper().then(function(a){g=a}),a.onClick=function(a,b){return!g||"right"!==g.state().state&&"left"!==g.state().state&&0===g.state().info.translation.absolute?(f.$broadcast("onItemClick",b.item),b.item.isActive=!0,void 0):(a.preventDefault(),a.stopPropagation(),void 0)}}]),app.controllers.controller("SideBarLeftController",["$scope","$location","$rootScope","_",function(a,b,c,d){a.user={name:"Baptiste",email:"hello@gmail.com"},a.$on("$locationChangeSuccess",function(){a.term=a.defaultTerm=void 0!==b.$$search.q?b.$$search.q:"Rechercher"}),a.$emit("$locationChangeSuccess"),a.cbs=[{checked:!0,value:"web",text:"Web",color:"green"},{checked:!0,value:"news",text:"Actualités",color:"orange"},{checked:!0,value:"social",text:"Social",color:"blue"},{checked:!0,value:"videos",text:"Medias",color:"red"},{checked:!0,value:"shopping",text:"Shopping",color:"yellow"}],a.onCbChange=function(){c.topics=d.where(a.cbs,{checked:!0})},a.onCbChange()}]),app.controllers.controller("SideBarRightController",["$scope","snapRemote","$rootScope","$timeout",function(a,b,c,d){c.$on("onItemClick",function(c,e){a.item=e,d(function(){b.open("right"),a.item.isActive=!1},500)})}]),angular.module("snap").directive("snapContent",["snapRemote",function(){return{restrict:"AE",link:function(a,b){console.log(b.css("left"))}}}]),app.directives.directive("oldheader",["snapRemote","$window",function(){return{restrict:"AE",templateUrl:"partials/header.html",link:function(){}}}]),app.filters.filter("detailsURL",["$location",function(a){return function(b){return a.$$absUrl.concat("&_id=",b)}}]),app.filters.filter("host",["$location",function(){return function(a){return 0!==a.indexOf("http")?a.split("/")[0].replace("www.",""):a.split("/")[2].replace("www.","")}}]),app.filters.filter("sce",["$sce",function(a){return function(b){return a.trustAsResourceUrl(b)}}]),app.filters.filter("yturlformat",function(){return function(a){return a.concat("?showinfo=0")}}),app.filters.filter("pricing",function(){return function(a){return a.replace("&euro;","€")}}),app.filters.filter("topicsFilter",["_",function(a){return function(b){return a.pluck(b,"value").join(",")}}]),app.filters.filter("ellipsis",function(){return function(a){return a.length>140?a.substring(0,140)+"[...]":a}}),app.filters.filter("hqthumb",function(){return function(a){var b=a.substring(a.lastIndexOf("/")+1,a.length);return"default.jpg"===b?a.replace("default.jpg","hqdefault.jpg"):a}}),app.services.value("ConfigManager",{searchUrl:"/search"}),app.services.factory("SearchManager",["$http","ConfigManager","$rootScope",function(a,b){return{items:[],url:b.searchUrl,busy:!1,term:"",currentPage:1,perPage:10,reset:!0,nextPage:function(b){var c=this;this.busy||(this.busy=!0,a.get(this.url,{params:{q:b,page:this.currentPage,source:this.source,size:this.perPage},cache:!0}).success(function(a){var d=a.items?a.items:a[c.source];angular.forEach(d,function(a){c.items.push(a)}),c.term=b,c.currentPage++,c.busy=!1}))}}}]),angular.module("underscore",[]).factory("_",function(){return window._});