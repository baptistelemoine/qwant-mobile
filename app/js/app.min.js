/*! qwant-mobile - v - 2013-10-25 */"use strict";var app=angular.module("qwant",["ngRoute","qwant.filters","qwant.services","qwant.directives","qwant.controllers","ngSanitize","infinite-scroll","snap"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"partials/home.html",controller:"HomeController"}),a.when("/search",{templateUrl:"partials/searchResult.html",controller:"SearchController"}),a.otherwise({redirectTo:"/"})}]);app.services=angular.module("qwant.services",[]),app.controllers=angular.module("qwant.controllers",[]),app.controllers.controller("HomeController",["$scope",function(){}]),app.controllers.controller("SearchController",["$scope","SearchManager","$location",function(a,b,c){a.term=c.search().q,b.setSource("all"),a.search=b,b.nextPage(a.term)}]),app.controllers.controller("SideBarController",["$scope","$window","snapRemote",function(a){a.user={name:"Baptiste Lemoine",email:"baptiste.lemoine@gmail.com"}}]),angular.module("snap").directive("snapDrawers",["$window",function(a){return{restrict:"AE",link:function(b,c){a.addEventListener("scroll",function(){c.css("top",this.document.documentElement.scrollTop||this.document.body.scrollTop)}),b.$on("destroy",function(){a.removeEventListener("scroll")})}}}]);var directives=angular.module("qwant.directives",[]),filters=angular.module("qwant.filters",[]);app.services.value("ConfigManager",{searchUrl:"/search"}),app.services.factory("SearchManager",["$http","ConfigManager","$rootScope",function(a,b){return{items:[],url:b.searchUrl,busy:!1,term:"",currentPage:0,perPage:10,source:"all",setSource:function(a){this.source=a},resetSearch:function(){this.items=[],this.currentPage=0},nextPage:function(b){var c=this;if(!this.busy){this.busy=!0,this.term!==b&&this.resetSearch();var d=this.currentPage>0?this.currentPage*this.perPage:0;a.get(this.url,{params:{q:b,offset:d,source:this.source},cache:!0}).success(function(a){var d=a.items?a.items:a[c.source];angular.forEach(d,function(a){c.items.push(a)}),c.term=b,c.currentPage++,c.busy=!1})}}}}]);